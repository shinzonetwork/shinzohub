{
  "policyDefinition": "name: shinzo\nresources:\n  primitive:\n\t\trelations:\n\t\t\tadmin:\n\t\t\t\tmanages:\n\t\t\t\t- writer\n\t\t\t\t- reader\n\t\t\t\t- banned\n\t\t\t\ttypes:\n\t\t\t\t- actor\n\t\t\t\t- group->administrator\n\t\t\twriter:\n\t\t\t\ttypes:\n\t\t\t\t- actor\n\t\t\t\t- group->member\n\t\t\treader:\n\t\t\t\ttypes:\n\t\t\t\t- actor\n\t\t\t\t- group->member\n\t\t\tsubscriber:\n\t\t\t\ttypes:\n\t\t\t\t- actor\n\t\t\tbanned:\n\t\t\t\ttypes:\n\t\t\t\t- actor\n\t\tpermissions:\n\t\t\tread:\n\t\t\t\texpr: (writer + reader) - banned\n\t\t\tupdate:\n\t\t\t\texpr: writer - banned\n\t\t\tdelete:\n\t\t\t\texpr: owner\n\t\t\tquery:\n\t\t\t\texpr: (subscriber) - banned\n  view:\n    relations:\n      admin:\n        manages:\n        - writer\n        - reader\n        - subscriber\n        - banned\n        types:\n        - actor\n        - group->administrator\n      creator:\n        types:\n        - actor\n      writer:\n        types:\n        - actor\n        - group->member\n      reader:\n        types:\n        - actor\n        - group->member\n      banned:\n        types:\n        - actor\n      subscriber:\n        types:\n        - actor\n      parent:\n        types:\n        - primitive\n        - view\n    permissions:\n      read:\n        expr: ((writer + reader) & parent->read) + subscriber - banned\n      update:\n        expr: ((writer + parent->update) & parent->read) - banned\n      query:\n        expr: (subscriber) - banned\n      delete:\n        expr: owner\n  group:  \n    relations:\n      owner:\n        manages:\n        - admin\n        - guest\n        - blocked\n        types:\n        - actor\n      admin:\n        manages:\n        - guest\n        - blocked\n        types:\n        - actor\n        - group->administrator\n      guest:\n        types:\n        - actor\n      blocked:\n        types:\n        - actor\n    permissions:\n      member:\n        expr: guest  - blocked\n      administrator:\n        expr: (owner + admin) - blocked",
  "policyTheorem": "Authorizations {\n  // @@@ blocks tests\n  primitive:blocks#read@did:user:randomUser\n  !primitive:blocks#update@did:user:randomUser\n  !primitive:blocks#query@did:user:randomUser\n\n  primitive:blocks#read@did:user:aHost\n  !primitive:blocks#update@did:user:aHost\n  !primitive:blocks#query@did:user:aHost\n\n  primitive:blocks#read@did:user:anindexer\n  primitive:blocks#update@did:user:anindexer\n  !primitive:blocks#query@did:user:anIndexer\n\n  !primitive:blocks#read@did:user:duncan \n  !primitive:blocks#update@did:user:duncan\n  !primitive:blocks#query@did:user:duncan\n  !primitive:blocks#read@did:user:addo\n  !primitive:blocks#update@did:user:addo\n  !primitive:blocks#query@did:user:addo\n  !primitive:blocks#read@did:user:quinn\n  !primitive:blocks#update@did:user:quinn\n  !primitive:blocks#query@did:user:quinn\n  !primitive:blocks#read@did:user:daniel\n  !primitive:blocks#update@did:user:daniel\n  !primitive:blocks#query@did:user:daniel\n\n  !primitive:blocks#read@did:user:shinzohub\n  !primitive:blocks#update@did:user:shinzohub\n  !primitive:blocks#query@did:user:shinzohub\n\n  !primitive:blocks#read@did:user:unregisteredUser\n  !primitive:blocks#update@did:user:unregisteredUser\n  !primitive:blocks#query@did:user:unregisteredUser\n\n  !primitive:blocks#read@did:user:aBlockedIndexer\n  !primitive:blocks#update@did:user:aBlockedIndexer\n  !primitive:blocks#query@did:user:aBlockedIndexer\n\n  !primitive:blocks#read@did:user:aBannedIndexer\n  !primitive:blocks#update@did:user:aBannedIndexer\n  !primitive:blocks#query@did:user:aBannedIndexer\n\n  !primitive:blocks#read@did:user:aBlockedHost\n  !primitive:blocks#update@did:user:aBlockedHost\n  !primitive:blocks#query@did:user:aBlockedHost\n\n  // @@@ Secondary data feed (a data feed derived directly from primitives) tests\n  view:datafeedA#read@did:user:subscriber\n  !view:datafeedA#update@did:user:subscriber\n  view:datafeedA#query@did:user:subscriber\n  !view:datafeedA#creator@did:user:subscriber\n\n  !view:datafeedA#read@did:user:subscriberToB\n  !view:datafeedA#update@did:user:subscriberToB\n  !view:datafeedA#query@did:user:subscriberToB\n  !view:datafeedA#creator@did:user:subscriberToB\n\n  !view:datafeedA#read@did:user:anonsubscriber\n  !view:datafeedA#update@did:user:anonsubscriber\n  !view:datafeedA#query@did:user:anonsubscriber\n  !view:datafeedA#creator@did:user:anonsubscriber\n\n  view:datafeedA#read@did:user:aHost\n  view:datafeedA#update@did:user:aHost\n  !view:datafeedA#query@did:user:aHost\n  !view:datafeedA#creator@did:user:aHost\n\n  !view:datafeedA#read@did:user:creator\n  !view:datafeedA#update@did:user:creator\n  !view:datafeedA#query@did:user:creator\n  view:datafeedA#creator@did:user:creator\n\n  !view:datafeedA#read@did:user:creatorOfB\n  !view:datafeedA#update@did:user:creatorOfB\n  !view:datafeedA#query@did:user:creatorOfB\n  !view:datafeedA#creator@did:user:creatorOfB\n\n  !view:datafeedA#read@did:user:addo\n  !view:datafeedA#update@did:user:addo\n  !view:datafeedA#query@did:user:addo\n  !view:datafeedA#creator@did:user:addo\n\n  !view:datafeedA#read@did:user:shinzohub\n  !view:datafeedA#update@did:user:shinzohub\n  !view:datafeedA#query@did:user:shinzohub\n  !view:datafeedA#creator@did:user:shinzohub\n\n  !view:datafeedA#read@did:user:aBannedHost\n  !view:datafeedA#update@did:user:aBannedHost\n  !view:datafeedA#query@did:user:aBannedHost\n  !view:datafeedA#creator@did:user:aBannedHost\n\n  !view:datafeedA#read@did:user:aBlockedHost\n  !view:datafeedA#update@did:user:aBlockedHost\n  !view:datafeedA#query@did:user:aBlockedHost\n  !view:datafeedA#creator@did:user:aBlockedHost\n\n  !view:datafeedA#read@did:user:anIndexer\n  !view:datafeedA#update@did:user:anIndexer\n  !view:datafeedA#query@did:user:anIndexer\n  !view:datafeedA#creator@did:user:anIndexer\n\n  // @@@ Tertiary data feed (a datafeed derived directly from another data feed) tests\n  !view:datafeedB#read@did:user:subscriber\n  !view:datafeedB#update@did:user:subscriber\n  !view:datafeedB#query@did:user:subscriber\n  !view:datafeedB#creator@did:user:subscriber\n\n  view:datafeedB#read@did:user:subscriberToB\n  !view:datafeedB#update@did:user:subscriberToB\n  view:datafeedB#query@did:user:subscriberToB\n  !view:datadeefB#creator@did:user:subscriberToB\n\n  !view:datafeedB#read@did:user:anonsubscriber\n  !view:datafeedB#update@did:user:anonsubscriber\n  !view:datafeedB#query@did:user:anonsubscriber\n  !view:datafeedB#creator@did:user:anonsubscriber\n\n  // Members of the host group inherit write permissions on datafeedB as they have it for datafeedA and datafeedA is datafeedB's parent\n  view:datafeedB#read@did:user:aHost\n  view:datafeedB#update@did:user:aHost\n  !view:datafeedB#query@did:user:aHost\n  !view:datafeedB#creator@did:user:aHost\n\n  !view:datafeedB#read@did:user:creator\n  !view:datafeedB#update@did:user:creator\n  !view:datafeedB#query@did:user:creator\n  !view:datafeedB#creator@did:user:creator\n\n  !view:datafeedB#read@did:user:creatorOfB\n  !view:datafeedB#update@did:user:creatorOfB\n  !view:datafeedB#query@did:user:creatorOfB\n  view:datafeedB#creator@did:user:creatorOfB\n\n  !view:datafeedB#read@did:user:addo\n  !view:datafeedB#update@did:user:addo\n  !view:datafeedB#query@did:user:addo\n  !view:datafeedB#creator@did:user:addo\n\n  !view:datafeedB#read@did:user:shinzohub\n  !view:datafeedB#update@did:user:shinzohub\n  !view:datafeedB#query@did:user:shinzohub\n  !view:datafeedB#creator@did:user:shinzohub\n\n  !view:datafeedB#read@did:user:aBannedHost\n  !view:datafeedB#update@did:user:aBannedHost\n  !view:datafeedB#query@did:user:aBannedHost\n  !view:datafeedB#creator@did:user:aBannedHost\n\n  !view:datafeedB#read@did:user:aBlockedHost\n  !view:datafeedB#update@did:user:aBlockedHost\n  !view:datafeedB#query@did:user:aBlockedHost\n  !view:datafeedB#creator@did:user:aBlockedHost\n\n  !view:datafeedB#read@did:user:anIndexer\n  !view:datafeedB#update@did:user:anIndexer\n  !view:datafeedB#query@did:user:anIndexer\n  !view:datafeedB#creator@did:user:anIndexer\n\n}\n\nDelegations {\n  // Shinzo Team group administration tests\n  !did:user:quinn > group:indexer#guest\n  !did:user:quinn > group:indexer#admin\n  !did:user:quinn > group:indexer#owner\n  did:user:duncan > group:indexer#guest\n  !did:user:duncan > group:indexer#admin\n  !did:user:duncan > group:indexer#owner\n  did:user:addo > group:indexer#guest\n  !did:user:addo > group:indexer#admin\n  !did:user:addo > group:indexer#owner\n\n  !did:user:quinn > group:host#guest\n  !did:user:quinn > group:host#admin\n  !did:user:quinn > group:host#owner\n  did:user:duncan > group:host#guest\n  !did:user:duncan > group:host#admin\n  !did:user:duncan > group:host#owner\n  did:user:addo > group:host#guest\n  !did:user:addo > group:host#admin\n  !did:user:addo > group:host#owner\n\n  !did:user:quinn > group:shinzoteam#guest\n  !did:user:quinn > group:shinzoteam#admin\n  !did:user:quinn > group:shinzoteam#owner\n  did:user:duncan > group:shinzoteam#guest\n  !did:user:duncan > group:shinzoteam#admin\n  !did:user:duncan > group:shinzoteam#owner\n  did:user:addo > group:shinzoteam#guest\n  did:user:addo > group:shinzoteam#admin\n  did:user:addo > group:shinzoteam#owner \n\n  // Shinzo team file administration \n  !did:user:addo > primitive:blocks#reader\n  !did:user:addo > primitive:blocks#writer\n  !did:user:addo > primitive:blocks#admin\n  !did:user:addo > primitive:blocks#owner\n\n  did:user:addo > view:datafeedA#reader\n  did:user:addo > view:datafeedA#writer\n  !did:user:addo > view:datafeedA#creator\n  !did:user:addo > view:datafeedA#admin\n  !did:user:addo > view:datafeedA#owner\n\n  did:user:addo > view:datafeedB#reader\n  did:user:addo > view:datafeedB#writer\n  !did:user:addo > view:datafeedB#creator\n  !did:user:addo > view:datafeedB#admin\n  !did:user:addo > view:datafeedB#owner\n\n  !did:user:duncan > primitive:blocks#reader\n  !did:user:duncan > primitive:blocks#writer\n  !did:user:duncan > primitive:blocks#admin\n  !did:user:duncan > primitive:blocks#owner\n\n  did:user:duncan > view:datafeedA#reader\n  did:user:duncan > view:datafeedA#writer\n  !did:user:duncan > view:datafeedA#creator\n  !did:user:duncan > view:datafeedA#admin\n  !did:user:duncan > view:datafeedA#owner\n\n  did:user:duncan > view:datafeedB#reader\n  did:user:duncan > view:datafeedB#writer\n  !did:user:duncan > view:datafeedB#creator\n  !did:user:duncan > view:datafeedB#admin\n  !did:user:duncan > view:datafeedB#owner\n\n  !did:user:quinn > primitive:blocks#reader\n  !did:user:quinn > primitive:blocks#writer\n  !did:user:quinn > primitive:blocks#admin\n  !did:user:quinn > primitive:blocks#owner\n\n  !did:user:quinn > view:datafeedA#reader\n  !did:user:quinn > view:datafeedA#writer\n  !did:user:quinn > view:datafeedA#creator\n  !did:user:quinn > view:datafeedA#admin\n  !did:user:quinn > view:datafeedA#owner\n\n  // Shinzo hub access administration tests\n  did:user:shinzohub > group:indexer#guest\n  !did:user:shinzohub > group:indexer#admin\n  !did:user:shinzohub > group:indexer#owner\n\n  did:user:shinzohub > group:host#guest\n  !did:user:shinzohub > group:host#admin\n  !did:user:shinzohub > group:host#owner\n\n  did:user:shinzohub > primitive:blocks#reader\n  did:user:shinzohub > primitive:blocks#writer\n  !did:user:shinzohub > primitive:blocks#admin\n  !did:user:shinzohub > primitive:blocks#owner\n\n  did:user:shinzohub > view:datafeedA#reader\n  did:user:shinzohub > view:datafeedA#writer\n  did:user:shinzohub > view:datafeedA#subscriber\n  !did:user:shinzohub > view:datafeedA#creator\n  !did:user:shinzohub > view:datafeedA#admin\n  !did:user:shinzohub > view:datafeedA#owner\n\n  did:user:shinzohub > view:datafeedB#reader\n  did:user:shinzohub > view:datafeedB#writer\n  did:user:shinzohub > view:datafeedB#subscriber\n  !did:user:shinzohub > view:datafeedB#creator\n  !did:user:shinzohub > view:datafeedB#admin\n  !did:user:shinzohub > view:datafeedB#owner\n}",
  "relationships": "primitive:blocks#owner@did:user:sourcehub\nprimitive:blocks#admin@did:user:shinzohub\nprimitive:blocks#writer@group:indexer#member\nprimitive:blocks#reader@group:host#member\nprimitive:blocks#reader@did:user:randomUser\nprimitive:blocks#banned@did:user:aBannedIndexer\nprimitive:blocks#subscriber@did:user:subscriber\n\nview:datafeedA#owner@did:user:sourcehub\nview:datafeedA#admin@did:user:shinzohub\nview:datafeedA#admin@group:shinzoteam#administrator\nview:datafeedA#creator@did:user:creator\nview:datafeedA#subscriber@did:user:subscriber\nview:datafeedA#writer@group:host#member\nview:datafeedA#banned@did:user:aBannedHost\nview:datafeedA#parent@primitive:blocks\n\nview:datafeedB#owner@did:user:sourcehub\nview:datafeedB#admin@did:user:shinzohub\nview:datafeedB#admin@group:shinzoteam#administrator\nview:datafeedB#creator@did:user:creatorOfB\nview:datafeedB#subscriber@did:user:subscriberToB\nview:datafeedB#parent@view:datafeedA\n\ngroup:shinzoteam#owner@did:user:addo \ngroup:shinzoteam#admin@did:user:duncan\ngroup:shinzoteam#guest@did:user:quinn\ngroup:shinzoteam#guest@did:user:daniel\n\ngroup:indexer#owner@did:user:sourcehub\ngroup:indexer#admin@did:user:shinzohub\ngroup:indexer#admin@group:shinzoteam#administrator\ngroup:indexer#guest@did:user:anIndexer\ngroup:indexer#guest@did:user:aBlockedIndexer\ngroup:indexer#blocked@did:user:aBlockedIndexer\ngroup:indexer#guest@did:user:aBannedIndexer\n\ngroup:host#owner@did:user:sourcehub\ngroup:host#admin@did:user:shinzohub\ngroup:host#admin@group:shinzoteam#administrator\ngroup:host#guest@did:user:aHost\ngroup:host#guest@did:user:aBlockedHost\ngroup:host#blocked@did:user:aBlockedHost"
}